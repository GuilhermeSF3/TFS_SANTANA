use sig

-- outros testes
exec [SCR_fin_operacao_proj] '2017-03-03','581', '4730', '2017-05-31'
select * from IOpen_Shop..OPN_CLIENTES (nolock) order by nome
CODIGO	AGENCIA_CODIGO	PESSOA_CODIGO	NOME
581	1	587	RICO CORRETORA DE TITULOS E VALORES IMOBILIARIOS SA
RICO CORRETORA DE TITULO E VVALORES IMOBILIARIOS SA
select * from IOpen_Shop..opn_movimento (nolock) where data='2017-03-03'
SELECT * FROM AUX_FIN_OPER (NOLOCK)
SELECT * FROM AUX_FIN_OPER_PROJ (NOLOCK)

-- outros testes
exec [SCR_fin_operacao_proj] '2017-03-03','653', '4733', '2017-05-31'
select * from IOpen_Shop..OPN_CLIENTES (nolock) order by nome
CODIGO	AGENCIA_CODIGO	PESSOA_CODIGO	NOME
653	1	659	DANIEL PIOLI TORRES
select * from IOpen_Shop..opn_movimento (nolock) where data='2017-03-03'
4733
SELECT * FROM AUX_FIN_OPER (NOLOCK)
SELECT * FROM AUX_FIN_OPER_PROJ (NOLOCK)

-- outros testes
exec [SCR_fin_operacao_proj] '2017-03-01','18', '4702', '2017-05-31'
select * from IOpen_Shop..OPN_CLIENTES (nolock) order by nome
CODIGO	NOME
18	BANCO BTG PACTUAL S.A.
select * from IOpen_Shop..opn_movimento (nolock) where data='2017-03-01'
4702  71  DI00170080F
SELECT * FROM AUX_FIN_OPER (NOLOCK)
SELECT * FROM AUX_FIN_OPER_PROJ (NOLOCK)

SET		@COD_TITULO = (select TITULO_CODIGO from iopen_shop..opn_movimento (nolock)  where codigo=4702)
SET		@PAPEL_COD  = (select PAPEL_CODIGO  from iopen_shop..opn_movimento (nolock)  where codigo=4702)
SET		@COD_PAPEL  = (select *
--CODIGO 
					--  where TITULO_CODIGO=@COD_TITULO AND PAPEL_CODIGO=@PAPEL_COD)
					  from	IOpen_Shop..OPN_PAPEL (NoLock) 
					  where 
						Data_operacao between '2017-03-01' and '2017-03-10'
order by PAPEL_CODIGO		-- DATA OPER
AND LEFT(PAPEL_CODIGO,8)=LEFT('DI00170080F',8) COLLATE DATABASE_DEFAULT
						AND INDICE_PERCENTUAL=@CDI_CLI ) -- TX CLIENTE


-- ok
exec [SCR_fin_operacao_proj] '2017-03-02','652', '4726', '2017-05-31'

SELECT * FROM AUX_FIN_OPER (NOLOCK)
SELECT * FROM AUX_FIN_OPER_PROJ (NOLOCK) ORDER BY DT_PROJ

SELECT * FROM  IOpen_Shop..GRL_FERIADO (NOLOCK) WHERE DATA>= '20180201'
2018-02-12 00:00:00.000 CARNAVAL SEG E TER
2018-02-13 00:00:00.000 

SELECT *	FROM	IOpen_Shop..GRL_INDICE_VALOR (nolock) 
	Where	indice_codigo=9  AND DATA>='20170531'  ORDER BY DATA
AND DATA = DT_PROJ

SELECT * FROM		AUX_FIN_OPER_PROJ
WHERE  COD_OPERACAO= '4726'  AND DATEPART(DW,DT_PROJ) IN (1,7) -- REMOVE O FDS

DELETE FROM		AUX_FIN_OPER_PROJ
WHERE  COD_OPERACAO= '4726'  AND DATEPART(DW,DT_PROJ) IN (1,7) -- REMOVE O FDS


-- ERRO DE ARREDONDAMENTO
SELECT POWER( (12.13000000/100.00000000 + 1.00000000), (1.00000000/252.00000000) ) -1.00000000
convert(float,ROUND( POWER( (CONVERT(FLOAT,ONTEM.TX_CDI)/100.0 + 1.0), (1.0/252.0) ) -1.0   , 8) )


25SEG
02/03/2017 00:00	652
4726
(No column name)	(No column name)
3118	116

SELECT * 	FROM	IOpen_Shop..OPN_POSCLIENTE (nolock)  
WHERE  papel_codigo= '3118' order by data


SELECT MAX(DATA) 	FROM	IOpen_Shop..OPN_POSCLIENTE (nolock)  
2017-05-18 00:00:00.000
WHERE  papel_codigo= 'RDB017001A1' order by data

SELECT * FROM TCDI 

----------------------
SCR_fin_operacao_proj		parametros ( dt_aplic, cliente_sel, nr_ativo)

use iopen_shop

-- tipo de oper
select * from opn_operacao (nolock)
50 tipos
CODIGO	DESCRICAO	TIPO_OPERACAO	MERCADO_CODIGO	SPB_CODIGO	SPB_CODIGO_TIPO_LEI	SPB_CODIGO_TIPO_COMP	SPB_TIPO_RET_COMP	SPB_TIPO_REP_IMP	SPB_TIPO_LIQ	DC	DEBITO_ESTOQUE	CREDITO_ESTOQUE	DEBITO_ESTOQUE_TER	CREDITO_ESTOQUE_TER	OPERACAO_VOLTA_CODIGO	PU_MEDIO	VISIVEL	MERCADO_CODIGO_CETIP
16	Emissão	16	0001	0001	NULL	NULL	NULL	NULL	NULL	C	NULL	14	NULL	NULL	NULL	0	1	0001

CODIGO	DESCRICAO
15	Resgate de Emissao

select * from GRL_MERCADO (nolock)
CODIGO	DESCRICAO	TIPO	DIAS_LIQUIDACAO
1	SELIC	S	0


-- operacoes
select * from opn_movimento (nolock)

CODIGO	AGENCIA_CODIGO	DATA	DATA_OPERACAO	TITULO_CODIGO	PAPEL_NOME	PAPEL_CODIGO	CURVA_CODIGO	INDICE_PERCENTUAL	COMPLEMENTO	TAXA	DATA_REPACTUACAO	CURVA_REPACTUACAO	INDICE_PERCENTUAL_REPAC	TAXA_REPACTUACAO	PU_INICIALFINAL	LOTE_CODIGO	CLIENTE_CODIGO	LIQUIDANTE_CODIGO	GERENTE_CODIGO	MOVIMENTO_COMPROMISSO	OPERACAO_CODIGO	FINANCEIRO	FINANCEIRO_VOLTA	APLICACAO	COMPROMISSO_DIA	COMPROMISSO_DATA	COMPROMISSO_CURVA	COMPROMISSO_TAXA	PU_ORIGINAL	DATA_ORIGINAL	COMANDO_ORIGINAL	APLICACAO_CURVA_CODIGO	APLICACAO_INDICE_PERCENTUAL	APLICACAO_TAXA	MOVIMENTO_APLICACAO	DATA_LIQUIDACAO	CONTA_CC_CODIGO	LIQUIDACAO_CODIGO	TIPO_CONTA_LIQ_CODIGO	CONTA_EMPRESA	CONTA_CONTRAPARTE	CAMARA_CODIGO	LIQ_CLEARING_CODIGO	CENTRAL_CODIGO	STATUS_LASTRO	STATUS_SPB	NIVEL_PREFERENCIA	OBS	CARTEIRA_CODIGO	TIPO_APLICACAO	GRUPO_CALCULO_CODIGO	AUTOMATICO	COMPROMISSO_TAXA_CONT
5067	1	2017-05-03 00:00:00.000	NULL	328	LC-PJNL	LC001700DRQ	84	110.500000	NULL	0.000000000000000000	NULL	NULL	NULL	NULL	1.000000000000000000	NULL	581	NULL	NULL	NULL	16	190100.00	0.00	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	84	NULL	NULL	NULL	NULL	NULL	2	207	03022009	12861000	2	NULL	NULL	1	N	NULL	NULL	0	4	NULL	0	0.000000000000000000
5068	1	2017-05-03 00:00:00.000	NULL	328	LC-PJNL	LC001700DRR	84	112.000000	NULL	0.000000000000000000	NULL	NULL	NULL	NULL	1.000000000000000000	NULL	581	NULL	NULL	NULL	16	15000.00	0.00	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	84	NULL	NULL	NULL	NULL	NULL	2	207	03022009	12861000	2	NULL	NULL	1	N	NULL	NULL	0	4	NULL	0	0.000000000000000000
5069	1	2017-05-03 00:00:00.000	NULL	330	RDB-PFNL	RDB017006C4	84	110.000000	NULL	0.000000000000000000	NULL	NULL	NULL	NULL	1.000000000000000000	NULL	567	NULL	NULL	NULL	16	35000.00	0.00	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	84	NULL	NULL	NULL	NULL	NULL	3	161	03022009	03022401	2	NULL	NULL	1	N	NULL	NULL	0	4	NULL	0	0.000000000000000000
5070	1	2017-05-03 00:00:00.000	NULL	332	RDB-PJNL	RDB017006C3	84	120.000000	NULL	0.000000000000000000	NULL	NULL	NULL	NULL	1.000000000000000000	NULL	485	NULL	NULL	NULL	16	200000.00	0.00	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	84	NULL	NULL	NULL	NULL	NULL	3	161	03022009	03022401	2	NULL	NULL	1	N	NULL	NULL	0	4	NULL	0	0.000000000000000000
5071	1	2017-05-03 00:00:00.000	NULL	328	LC-PJNL	LC001700DRT	84	112.000000	NULL	0.000000000000000000	NULL	NULL	NULL	NULL	1.000000000000000000	NULL	117	NULL	NULL	NULL	16	110000.00	0.00	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	84	NULL	NULL	NULL	NULL	NULL	2	207	03022009	03022009	2	NULL	NULL	1	N	NULL	NULL	0	4	NULL	0	0.000000000000000000
5092	1	2017-05-08 00:00:00.000	2017-05-08 00:00:00.000	330	RDB-PFNL	RDB01600230	84	110.000000	BRSNTNRDB2E5	0.000000000000000000	NULL	84	110.000000	0.000000000000000000	1.000000000000000000	0	364	NULL	NULL	NULL	15	14903.43	0.00	NULL	0	NULL	NULL	0.000000000000000000	NULL	NULL	NULL	NULL	NULL	NULL	2997	NULL	NULL	3	161	03022009	03022401	2	NULL	NULL	1	NULL	0	NULL	0	NULL	NULL	1	0.000000000000000000
5093	1	2017-05-08 00:00:00.000	2017-05-08 00:00:00.000	330	RDB-PFNL	RDB016004YQ	84	105.000000	NULL	0.000000000000000000	NULL	NULL	NULL	NULL	1.000000000000000000	NULL	562	NULL	NULL	NULL	15	2128.45	0.00	NULL	0	NULL	NULL	0.000000000000000000	NULL	NULL	NULL	NULL	NULL	NULL	3794	NULL	NULL	3	161	03022009	03022401	2	NULL	NULL	1	NULL	0	NULL	0	NULL	NULL	1	0.000000000000000000
5094	1	2017-05-08 00:00:00.000	NULL	330	RDB-PFNL	RDB017006TH	84	110.000000	NULL	0.000000000000000000	NULL	NULL	NULL	NULL	1.000000000000000000	NULL	696	NULL	NULL	NULL	16	2000.00	0.00	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	84	NULL	NULL	NULL	NULL	NULL	3	161	03022009	03022401	2	NULL	NULL	1	N	NULL	NULL	0	4	NULL	0	0.000000000000000000


select max(data) from opn_movimento (nolock)
homolog
2016-08-26 00:00:00.000
prod
2017-05-19 00:00:00.000 hj

select * from opn_movimento (nolock) where data='20170502'
5050

tipo_aplicacao carteira_codigo  obs    nivel_preferencia
chave : titulo_codigo


select * from  dbo.SWA_FATOR_COTACAO (nolock)

select * from  dbo.SWA_RCDI_TAB1 (nolock)
INDICE_CODIGO	PRAZO	TAXA
104	420	0.080800000000000000



select * from  dbo.SWA_RCDI_TAB2 (nolock)
TIPO_TRAVA_CODIGO	TAXA
101	1.000000000000000000
72	0.800000000000000000

-- vazios em prod
select * from  dbo.SWA_RCDI_TAB3 (nolock)

select * from  dbo.SWA_REMUNERACAO (nolock)

-- vazios em prod
select * from  dbo.SWA_TAxabmf (nolock)
select * from  dbo.SWA_FATOR_COTACAO

-- ok feriados no iopen
select * from  dbo.GRL_FERIADO order by data
-- nao precisa
select * from  dbo.GRL_FERIADO_FIXO

-- codigos
select * from  dbo.GRL_INDICE
CODIGO	NOME
9	CDI

select * from  dbo.GRL_INDICE_VALOR (nolock) where indice_codigo=9 order by data
2016-08-25 00:00:00.000
2017-05-02 00:00:00.000  ontem

DATA	INDICE_CODIGO	VALOR
2017-03-22 00:00:00.000	9	12.130000000000000000  tx aa em mar/17

DATA	INDICE_CODIGO	VALOR
2017-05-12 00:00:00.000	9	11.130000000000000000
2017-05-15 00:00:00.000	9	11.130000000000000000
2017-05-16 00:00:00.000	9	11.130000000000000000
2017-05-17 00:00:00.000	9	11.130000000000000000
2017-05-18 00:00:00.000	9	11.130000000000000000

soh dias uteis

-- calcular o fator diario

select * from dbo.OPN_CLIENTES (nolock) order by nome

-- gerente *************** comissao ?
select * from dbo.OPN_GERENTE (nolock)
CODIGO	NOME
1	SANTANA
2	CP & FRIZZO
3	ICAP DO BRASIL CTVM
4	TENDENCIA CCTVM
5	PROSPER CORRETORA

select * from dbo.OPN_GRUPOS (nolock)
GRUPO	DESCRICAO
OPN	GRUPO PADRÃO

-- vazios
select * from dbo.LOG_OPN_USUARIOS (nolock)

select * from dbo.LOG_GRL_REGIME (nolock)

select * from dbo.LOG_GRL_SETOR (nolock)
select * from dbo.LOG_OPN_GRUPO_CALCULO (nolock)
select * from dbo.LOG_OPN_LIQ_COMPROMISSO (nolock)
select * from dbo.LOG_OPN_LIQ_FINANCEIRA (nolock)
select * from dbo.LOG_OPN_LIQUIDACAO_CLEARING (nolock)

84

select * from  dbo.SWA_RCDI_TAB2 (nolock)

TIPO_TRAVA_CODIGO	TAXA
84	0.200000000000000000


161

-- vazias
select * from  dbo.LOG_OPN_PU (nolock)
select * from  dbo.LOG_OPN_PU_COTACAO (nolock)
select * from  dbo.LOG_OPN_TAXAS_APLICACAO (nolock)
select * from  LOG_OPN_TIPO_CONTA_LIQUIDACAO (nolock)
select * from  dbo.LOG_OPN_TIPO_ESTOQUE (nolock)
select * from  dbo.LOG_OPN_TIPOS_CARTEIRA (nolock)
select * from  dbo.LOG_OPN_TITULO (nolock)
select * from  dbo.OPN_COMPLEMENTO_CCB (nolock)

select * from  dbo.OPN_MOVIMENTO_DETALHES (nolock)
Codigo	Parametro	Sequencial	Valor
0	COMITENTE_ARQ	0	
0	COMITENTE_DATA	0	
0	COMITENTE_ENV	0	

select * from  dbo.OPN_MOVIMENTO_LASTRO (nolock)
MOVIMENTO_CODIGO	PAPEL_CODIGO	COMANDO	COMANDO_LIGADO	FINANCEIRO	FINANCEIRO_VOLTA	PU	PU_VOLTA	QUANTIDADE	QUANTIDADE_TER	QUANTIDADE_CCB
5050	1821	2	NULL	228973.72	0.00	1144.868605000000000000	0.000000000000000000	200.0000000000	0.0000000000	NULL

select * from dbo.OPN_PAPEL (nolock)
CODIGO	TITULO_CODIGO	PAPEL_NOME	PAPEL_CODIGO	COMPLEMENTO	DATA_VENCIMENTO	CURVA_CODIGO	INDICE_PERCENTUAL	TAXA	DATA_REPACTUACAO	CURVA_REPACTUACAO	INDICE_PERCENTUAL_REPAC	TAXA_REPACTUACAO	DATA_OPERACAO	LOTE_CODIGO	PU_INICIALFINAL	DATA_EMISSAO	DATA_BASE_EMISSAO	DATA_BASE_VENCIMENTO	DATA_PAGAMENTO_JUROS	DIAS_PAGAMENTO	DIAS_CARENCIA	DIAS_PAGAMENTO_FIXO	DIAS_INICIO_EMISSAO	PAGAMENTO_JUROS	PAGAMENTO_CORRECAO	PAGAMENTO_PRINCIPAL	PU_BASE	CURVA_BASE	INDICE_PERCENTUAL_BASE	TAXA_BASE	CAPTALIZA_EMISSAO	EMITENTE_CODIGO	CASAS_QUANTIDADE	FIR	TAXA_CONTABIL
16	325	LC-PFL	SANTF0017	NULL	2011-04-15 00:00:00.000	84	123.000000	0.000000000000000000	NULL	84	123.000000	0.000000000000000000	NULL	0	1000.000000000000000000	2010-04-15 00:00:00.000	2010-04-15 00:00:00.000	2011-04-15 00:00:00.000	1899-12-30 00:00:00.000	365	253	0	0	0	NULL	NULL	1000.000000000000000000	84	123.000000	0.000000000000000000	1	1	0	0.000000000000000000	0.000000000000000000


select * from dbo.OPN_PAPEL_AGENDA (nolock)

-- vazio
select * from dbo.OPN_PERFIL_CLIENTE (nolock)
select * from dbo.OPN_PERFIL_OPERADOR (nolock)

select * from dbo.OPN_POSCLIENTE (nolock)  where papel_codigo= 1821 order by data

select * from dbo.SWA_CONTRATO (nolock) 
select * from dbo.SWA_GARANTIA (nolock) 
select * from dbo.SWA_MODALIDADE (nolock) 

-- vazio
select * from dbo.SWA_MOVIMENTO (nolock)
select * from dbo.SWA_POSESTOQUE (nolock) 
 
select * from dbo.SWA_OPERACAO (nolock) 
select * from dbo.SWA_PARAMETROS (nolock) 

select * from dbo.SWA_TMP_MOVIMENTO (nolock) 
select * from dbo.SWA_REMUNERACAO (nolock) 

CODIGO	DESCRICAO	TIPO
1	D 0	0
2	D -1	1
3	D -2	2


select * from								dbo.GRL_TIPO_PRODUTO (nolock) 
CODIGO	DESCRICAO	SIGLA	TIPO_IFT	TIPO_SNA
1	LFT - LETRA FINANCEIRA DO TESOURO	LFT	1	 
21	LTN - LETRA DO TESOURO NACIONAL	LTN	1	 
41	NBC - NOTAS DO BANCO CENTRAL	NBC	2	 
42	NTN - NOTAS DO TESOURO NACIONAL	NTN	1	 
61	CDI - CERTIFICADO DE DEPOSITO INTERFINANCEIRO	CDI	NULL	 
62	DI - RESERVA	DI	NULL	 
63	CDB - CERTIFICADO DE DEPOSITO BANCARIO	CDB	5	C
64	LBC - LETRA DO BANCO CENTRAL	LBC	NULL	 
65	TDA - TITULO DA DIVIDA AGRARIA	TDA	NULL	 
81	LC - LETRA DE CAMBIO	LC	NULL	 
82	DEB - DEBENTURES	DEB	8	P
101	LH - LETRA HIPOTECÁRIA	LH	0	0
121	CCB - CEDULA DE CREDITO BANCÁRIO	CCB	0	O
122	CCCB - CERTIFICADO DE CEDULA DE CRÉDITO BANCÁRIO	CCCB	0	O
125	CCB - COM GARANTIA OU QTDE <> 1	CCBG	0	O
126	CDI-R - CDI RURAL	CDI-R	0	0
127	DPGE - DEPOSITO A PRAZO COM GARANTIA ESPECIAL DO FGC	DPGE	0	D
128	CDBS - CERTIFICADO DE > DEPOSITO BANCÁRIO SUBORDINADO	CDBS	0	S
129	CDBV - CERTIFICADO DE > DEPOSITO BANCÁRIO VINCULADO	CDBV	0	V
43	NTN-F - NOTAS DO TESOURO NACIONAL	NTN-F	1	 
83	RDB - RECIBO DE DEPOSITO BANCÁRIO	RDB	0	 
130	LF - LETRA FINANCEIRA	LF	0	 
131	FI - FUNDO INVESTIMENTO	FI	0	0
140	LI - LETRA IMOBILIÁRIA	LI	0	I

vazio
select * from dbo.GRL_EMPRESA (nolock) 
select * from dbo.LOG_GRL_INDICE (nolock) 
select * from dbo.LOG_GRL_titulo (nolock) 
select * from dbo.LOG_OPN_GRUPOS (nolock) 
select * from dbo.OPN_TAXAS_APLICACAO (nolock) 

select * from dbo.GRL_REGIME (nolock)   -- casamento
CODIGO	DESCRICAO
2	COMUNHAO DE BENS
3	COMUNHAO PARCIAL DE BENS
4	SEPARACAO DE BENS

select * from dbo.LOG_GRL_INDICE_valor (nolock) 
O_DATA	O_INDICE_CODIGO	O_VALOR	N_DATA	N_INDICE_CODIGO	N_VALOR	LOG_DATA	LOG_USER	LOG_OPERACAO
2017-04-03 00:00:00.000	9	13.120000000000000000	2017-04-03 00:00:00.000	9	12.130000000000000000	2017-04-03 07:47:45.563	MARCELO	U
dias...

select * from dbo.Grl_setor (nolock)   -- setor de atividade do cliente


select * from dbo.GRL_AGENCIA (nolock) 
CODIGO	NOME	PESSOA_CODIGO	CARTA_PATENTE	LOGO
1	SANTANA S/A CRÉDITO FINANCIAMENTO E INVESTIMENTO	1	1	Y:\EXE\logo.bmp



select * from dbo.OPN_GERENTE (nolock) 
CODIGO	NOME
1	SANTANA
2	CP & FRIZZO
3	ICAP DO BRASIL CTVM
4	TENDENCIA CCTVM
5	PROSPER CORRETORA


select * from dbo.OPN_GRupos (nolock) 
GRUPO	DESCRICAO
OPN	GRUPO PADRÃO

select * from dbo.OPN_papel (nolock) 
CODIGO	TITULO_CODIGO	PAPEL_NOME	PAPEL_CODIGO	COMPLEMENTO	DATA_VENCIMENTO	CURVA_CODIGO	INDICE_PERCENTUAL	TAXA	DATA_REPACTUACAO	CURVA_REPACTUACAO	INDICE_PERCENTUAL_REPAC	TAXA_REPACTUACAO	DATA_OPERACAO	LOTE_CODIGO	PU_INICIALFINAL	DATA_EMISSAO	DATA_BASE_EMISSAO	DATA_BASE_VENCIMENTO	DATA_PAGAMENTO_JUROS	DIAS_PAGAMENTO	DIAS_CARENCIA	DIAS_PAGAMENTO_FIXO	DIAS_INICIO_EMISSAO	PAGAMENTO_JUROS	PAGAMENTO_CORRECAO	PAGAMENTO_PRINCIPAL	PU_BASE	CURVA_BASE	INDICE_PERCENTUAL_BASE	TAXA_BASE	CAPTALIZA_EMISSAO	EMITENTE_CODIGO	CASAS_QUANTIDADE	FIR	TAXA_CONTABIL
3387	328	LC-PJNL	LC001700ET1	NULL	2018-05-07 00:00:00.000	84	110.500000	0.000000000000000000	NULL	NULL	0.000000	0.000000000000000000	2017-05-10 00:00:00.000	NULL	1.000000000000000000	2017-05-10 00:00:00.000	2017-05-10 00:00:00.000	2018-05-07 00:00:00.000	1899-12-30 00:00:00.000	362	247	0	0	0	0	0	1.000000000000000000	84	110.500000	0.000000000000000000	1	1	2	0.000000000000000000	0.000000000000000000
varios...


select * from dbo.OPN_TIPO_ESTOQUE (nolock) 
TIPO	DESCRICAO	CONTROLA_CARTEIRA
0	INTERMEDIADOS (COMPRA E VENDA NO MESMO DIA)	0
1	LIVRE (PROPRIO)	1
2	LIVRE (TERCEIROS)	1
3	VINCULADOS A RECOMPRA	1
4	BACEN - RESERVAS COMPULSORIAS EM TITULOS	1
5	BACEN - DEPOSITOS PARA CARTEIRA EM TITULOS	1
6	BACEN - REDESCONTO (PROPRIO)	1
7	BACEN - TITULOS VINCULADOS A RECURSOS EXTERNOS	1
8	BACEN - TITULOS VINCULADOS A RECURSO DE POUPANCA	1
9	TITULOS DE RENDA FIXA BLOQUEADOS	1
10	VINCULADOS A AQUISICAO DE EMPRESAS ESTATAIS	1
11	VINCULADOS A PRESTACAO DE GARANTIAS DE OPERACOES EM BOLSA	1
12	VINCULADOS A PRESTACAO DE GARANTIAS (OUTROS)	1
13	MANTIDOS EM CARTEIRA ATE O VENCIMENTO	1
14	TITULOS DE EMISSAO PROPRIA	1
15	TERCEIROS (LIVRE NEGOCIAÇÃO)	1
16	VINCULADOS A RECOMPRA (LIVRE NEGOCIAÇÃO)	1
17	BACEN - REDESCONTO TERCEIROS	1
18	CEDULAS DE "CCB" VINCULADAS A CETIFICADOS "CCC"	1

select * from dbo.OPN_TIPOs_carteira (nolock) 
CODIGO	DESCRICAO	TEXTO_ADICIONAL_HISTORICO
0	TÍTULO SEM CLASSIFICAÇÃO	 (SC)
1	TÍTULO LIVRE NEGOCIAÇÃO	 (TÍTULO LIVRE NEGOCIAÇÃO)
2	TÍTULO DISPONÍVEL PARA VENDA	(TÍTULO DISPONÍVEL PARA VENDA)
3	TÍTULO MANTIDO ATÉ O VENCIMENTO	 (TÍTULO MANTIDO ATÉ O VENCIMENTO)


select * from opn_central (nolock)
CODIGO	DESCRICAO
1	BACEN
2	CETIP
6	SELIC

select * from opn_camara (nolock)
CODIGO	DESCRICAO	TIPO_MERCADO
1	BACEN	S
2	CETIP	C
3	CIP	O
6	SELIC	S
61	STR	C
81	SND	C
161	SNA	C

select * from GRL_TIPO_CTA_CLIENTE (nolock)
CODIGO	DESCRICAO
1	conta de investimento
2	conta corrente

-- vazio
select * from LOG_GRL_CLIENTE_CONTA_CC (nolock)
select * from LOG_GRL_TIPO_CTA_CLIENTE (nolock)
select * from LOG_GRL_TITulo (nolock)
select * from LOG_OPN_CAMARA (nolock)
select * from LOG_OPN_Central (nolock)
select * from GRL_TRACE (nolock)


select * from opn_movimento (nolock)
where data='20170301'


select * from opn_movimento (nolock)
where data='20170302'

select * from opn_movimento (nolock)
where data='20170303'

codigo='123'

select * from dbo.OPN_PAPEL (nolock)	where papel_codigo in ('RDB01700190')

'RDB017006C4')

	where codigo in (5069)

where papel_codigo in ('RDB0170018O','RDB0170018N')

	where titulo_codigo in (330)

select * from dbo.OPN_PAPEL (nolock)	where papel_codigo in ('LC0017005VH','RDB017001AO','LC001600360','LC0017005W8')


330

	where codigo in (4699,4700)

select * from dbo.OPN_CLIENTES (nolock) where gerente_codigo=472

select * from dbo.OPN_CLIENTES (nolock) where codigo=472
CODIGO	AGENCIA_CODIGO	PESSOA_CODIGO	NOME	CODIGO_EXTRA	BANCO_LIQUIDANTE	APLICACAO_CURVA_CODIGO	APLICACAO_INDICE_PERCENTUAL	APLICACAO_TAXA	GERENTE_CODIGO	NUMERO_SELIC	NUMERO_CETIP	NUMERO_SPB	CODIGO_EMITENTE
472	1	477	GIOVANNO SCARANTE CEZAROTTO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	01441082	SANTANA


select * from dbo.GRL_AGENCIA (nolock) 
CODIGO	NOME	PESSOA_CODIGO	CARTA_PATENTE	LOGO
1	SANTANA S/A CRÉDITO FINANCIAMENTO E INVESTIMENTO	1	1	Y:\EXE\logo.bmp


select * from dbo.OPN_PAPEL (nolock)	where papel_codigo in ('RDB0170018O')
CODIGO	TITULO_CODIGO	PAPEL_NOME	PAPEL_CODIGO	COMPLEMENTO	DATA_VENCIMENTO	CURVA_CODIGO	INDICE_PERCENTUAL	TAXA	DATA_REPACTUACAO	CURVA_REPACTUACAO	INDICE_PERCENTUAL_REPAC	TAXA_REPACTUACAO	DATA_OPERACAO	LOTE_CODIGO	PU_INICIALFINAL	DATA_EMISSAO	DATA_BASE_EMISSAO	DATA_BASE_VENCIMENTO	DATA_PAGAMENTO_JUROS	DIAS_PAGAMENTO	DIAS_CARENCIA	DIAS_PAGAMENTO_FIXO	DIAS_INICIO_EMISSAO	PAGAMENTO_JUROS	PAGAMENTO_CORRECAO	PAGAMENTO_PRINCIPAL	PU_BASE	CURVA_BASE	INDICE_PERCENTUAL_BASE	TAXA_BASE	CAPTALIZA_EMISSAO	EMITENTE_CODIGO	CASAS_QUANTIDADE	FIR	TAXA_CONTABIL
3112	330	RDB-PFNL	RDB0170018O	NULL	2019-02-20 00:00:00.000	84	112.000000	0.000000000000000000	NULL	NULL	0.000000	0.000000000000000000	2017-03-01 00:00:00.000	NULL	1.000000000000000000	2017-03-01 00:00:00.000	2017-03-01 00:00:00.000	2019-02-20 00:00:00.000	NULL	721	494	0	0	0	0	0	1.000000000000000000	84	112.000000	0.000000000000000000	1	1	2	0.000000000000000000	0.000000000000000000
3107	330	RDB-PFNL	RDB0170018O	NULL	2019-02-20 00:00:00.000	84	112.000000	0.000000000000000000	NULL	NULL	NULL	NULL	2017-03-01 00:00:00.000	NULL	1.000000000000000000	2017-03-01 00:00:00.000	2017-03-01 00:00:00.000	2019-02-20 00:00:00.000	NULL	721	494	0	0	0	0	0	1.000000000000000000	84	112.000000	0.000000000000000000	1	1	2	0.000000000000000000	0.000000000000000000

select * from dbo.OPN_PAPEL (nolock)	where papel_codigo in ('RDB0170018N')
CODIGO	TITULO_CODIGO	PAPEL_NOME	PAPEL_CODIGO	COMPLEMENTO	DATA_VENCIMENTO	CURVA_CODIGO	INDICE_PERCENTUAL	TAXA	DATA_REPACTUACAO	CURVA_REPACTUACAO	INDICE_PERCENTUAL_REPAC	TAXA_REPACTUACAO	DATA_OPERACAO	LOTE_CODIGO	PU_INICIALFINAL	DATA_EMISSAO	DATA_BASE_EMISSAO	DATA_BASE_VENCIMENTO	DATA_PAGAMENTO_JUROS	DIAS_PAGAMENTO	DIAS_CARENCIA	DIAS_PAGAMENTO_FIXO	DIAS_INICIO_EMISSAO	PAGAMENTO_JUROS	PAGAMENTO_CORRECAO	PAGAMENTO_PRINCIPAL	PU_BASE	CURVA_BASE	INDICE_PERCENTUAL_BASE	TAXA_BASE	CAPTALIZA_EMISSAO	EMITENTE_CODIGO	CASAS_QUANTIDADE	FIR	TAXA_CONTABIL
3113	330	RDB-PFNL	RDB0170018N	NULL	2021-02-08 00:00:00.000	84	116.000000	0.000000000000000000	NULL	NULL	0.000000	0.000000000000000000	2017-03-01 00:00:00.000	NULL	1.000000000000000000	2017-03-01 00:00:00.000	2017-03-01 00:00:00.000	2021-02-08 00:00:00.000	NULL	1440	988	0	0	0	0	0	1.000000000000000000	84	116.000000	0.000000000000000000	1	1	2	0.000000000000000000	0.000000000000000000
3108	330	RDB-PFNL	RDB0170018N	NULL	2021-02-08 00:00:00.000	84	116.000000	0.000000000000000000	NULL	NULL	NULL	NULL	2017-03-01 00:00:00.000	NULL	1.000000000000000000	2017-03-01 00:00:00.000	2017-03-01 00:00:00.000	2021-02-08 00:00:00.000	NULL	1440	988	0	0	0	0	0	1.000000000000000000	84	116.000000	0.000000000000000000	1	1	2	0.000000000000000000	0.000000000000000000

select * from opn_movimento (nolock) where codigo in (3113,3108)
LC0016008W9
LC0016008Y6

select * from dbo.OPN_PAPEL (nolock)	where papel_nome='LC-PRE'

-- resgate no vencimento 
select * from opn_movimento (nolock) where codigo in (4709)
movimento_aplicacao
2788					LC0016002ZO
select * from opn_movimento (nolock) where codigo in (2788)

select * from dbo.OPN_PAPEL (nolock)	where papel_codigo in ('LC0016002ZO')
emissao							vencimento 
2016-02-29 00:00:00.000			2017-03-01 00:00:00.000
CODIGO	TITULO_CODIGO	PAPEL_NOME	PAPEL_CODIGO	COMPLEMENTO	DATA_VENCIMENTO	CURVA_CODIGO	INDICE_PERCENTUAL	TAXA	DATA_REPACTUACAO	CURVA_REPACTUACAO	INDICE_PERCENTUAL_REPAC	TAXA_REPACTUACAO	DATA_OPERACAO	LOTE_CODIGO	PU_INICIALFINAL	DATA_EMISSAO	DATA_BASE_EMISSAO	DATA_BASE_VENCIMENTO	DATA_PAGAMENTO_JUROS	DIAS_PAGAMENTO	DIAS_CARENCIA	DIAS_PAGAMENTO_FIXO	DIAS_INICIO_EMISSAO	PAGAMENTO_JUROS	PAGAMENTO_CORRECAO	PAGAMENTO_PRINCIPAL	PU_BASE	CURVA_BASE	INDICE_PERCENTUAL_BASE	TAXA_BASE	CAPTALIZA_EMISSAO	EMITENTE_CODIGO	CASAS_QUANTIDADE	FIR	TAXA_CONTABIL
1711	328	LC-PJNL	LC0016002ZO	BRSNTNLC0DL7	2017-03-01 00:00:00.000	84	112.000000	0.000000000000000000	NULL	84	112.000000	0.000000000000000000	NULL	0	1.000000000000000000	2016-02-29 00:00:00.000	2016-02-29 00:00:00.000	2017-03-01 00:00:00.000	1899-12-30 00:00:00.000	366	253	0	0	0	NULL	NULL	1.000000000000000000	84	112.000000	0.000000000000000000	1	1	2	0.000000000000000000	0.000000000000000000

select codigo,nome from Iopen.OPN_CLIENTES (nolock) order by nome

select codigo from opn_movimento (nolock) where cliente_codigo in (117) and data ='2017-03-03'